% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filterLocations.R
\name{filterLocations}
\alias{filterLocations}
\title{Flag and invalidate spurious FastLoc GPS positions from animal tracking data}
\usage{
filterLocations(
  data,
  id.metadata,
  id.col = "ID",
  datetime.col = "datetime",
  position.type.col = "position_type",
  lon.col = "lon",
  lat.col = "lat",
  deploy.lon.col = "deploy_lon",
  deploy.lat.col = "deploy_lat",
  quality.col = "quality",
  max.speed.kmh = NULL,
  max.distance.km = 100,
  min.satellites = NULL,
  plot = TRUE
)
}
\arguments{
\item{data}{A list of data frames/tables or a single data frame containing tracking data.}

\item{id.metadata}{A data frame containing deployment information for each individual.}

\item{id.col}{Character string specifying the column name containing animal IDs (default: "ID").}

\item{datetime.col}{Character string specifying the datetime column (default: "datetime").}

\item{position.type.col}{Character string specifying the position type column (default: "position_type").}

\item{lon.col}{Character string specifying the longitude column (default: "lon").}

\item{lat.col}{Character string specifying the latitude column (default: "lat").}

\item{deploy.lon.col}{Character string specifying the deployment longitude column in metadata (default: "deploy_lon").}

\item{deploy.lat.col}{Character string specifying the deployment latitude column in metadata (default: "deploy_lat").}

\item{quality.col}{Character string specifying the quality/satellite count column (default: "quality").}

\item{max.speed.kmh}{Numeric, maximum allowed speed between consecutive positions (km/h). If NULL, skips speed filtering.}

\item{max.distance.km}{Numeric, maximum allowed distance from deployment location (km, default: 100).}

\item{min.satellites}{Integer, minimum number of satellites required for valid FastLoc positions (optional).}

\item{plot}{Logical, whether to generate diagnostic plots (default: TRUE).}
}
\value{
Returns a list of filtered data frames/tables (matching input structure) with:
\itemize{
\item Implausible positions set to NA (lon/lat/position_type/quality)
\item User positions always preserved
\item Summary statistics printed to console
}
}
\description{
Detects and removes implausible FastLoc GPS locations from animal tracking datasets
generated by Wildlife Computers tags.
}
\details{
The function supports two types of position data:
\itemize{
\item \code{"FastGPS"}: automatically acquired positions from the tag
\item \code{"User"}: manually added positions through the Wildlife Computers Data Portal
}

Implausible positions are identified based on the following validation checks:
\enumerate{
\item \strong{Speed Filtering}: Detects and removes locations that imply unrealistic movement speeds,
based on a user-defined maximum threshold (\code{max.speed.kmh}). The function operates iteratively:
it recalculates step speeds after each removal and continues until all remaining speeds are plausible
or a maximum number of iterations is reached. When a speed violation is detected, hierarchical clustering
is applied to the spatial coordinates of neighboring detections to identify and remove the most likely outlier
responsible for the overspeed.

\item \strong{Distance Check}: Flags positions that are located farther than a specified radius from the
deployment location (\code{max.distance.km}). This is useful for identifying early detections that may be erroneous
or not biologically plausible based on known release location.

\item \strong{Quality Control}: Optionally removes positions with low location quality, based on the number of
satellites used in the FastLoc GPS fix (\code{min.satellites}). Positions with fewer satellites than the threshold
are considered less reliable and can be excluded.
}

The function also checks for inconsistencies between "User" positions and the deployment location
provided in the metadata.

All flagged positions are set to \code{NA}, and diagnostic plots are generated
to support visual inspection of the filtering process.
}
