% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/getPaddleSpeed.R
\name{.getPaddleSpeed}
\alias{.getPaddleSpeed}
\title{Estimate Paddle Wheel Frequency (Optimized Block-wise FFT)}
\usage{
.getPaddleSpeed(
  mz,
  sampling.rate,
  window.size = 5,
  step.size = 1,
  min.freq.Hz = 0.1,
  max.freq.Hz = 30,
  calibration.slope,
  smooth.window = NULL,
  quality.check = TRUE,
  verbose = FALSE
)
}
\arguments{
\item{mz}{Numeric vector of magnetometer z-axis values. Missing values (\code{NA})
are not explicitly handled and may cause errors; consider pre-processing \code{mz}
to remove or impute \code{NA}s if they are present.}

\item{sampling.rate}{Sampling rate of the \code{mz} data in Hz (e.g., 100). Must be positive.}

\item{window.size}{Size of the FFT window in seconds (default: 5). Must be positive.}

\item{step.size}{Step size for overlapping windows in seconds (default: 1). Must be positive.}

\item{min.freq.Hz}{Minimum frequency (Hz) to consider for peak detection (default: 0.1).
This should be chosen based on the expected minimum paddle wheel rotation frequency.}

\item{max.freq.Hz}{Maximum frequency (Hz) to consider for peak detection (default: 5).
This should be chosen based on the expected maximum paddle wheel rotation frequency.}

\item{calibration.slope}{Numeric value representing the slope of the calibration line
(speed = slope * frequency). (default: 0.25).}

\item{smooth.window}{Smoothing window in seconds for the final frequency and
speed estimates (default: NULL). If provided, a rolling mean is applied.}

\item{quality.check}{Logical; if TRUE, calculates and returns a quality metric
for each frequency estimate, indicating the prominence of the detected peak
relative to other frequencies within the search band (default: TRUE).}

\item{verbose}{Logical; if TRUE, prints progress messages during execution (default: FALSE).}
}
\value{
A list with:
\itemize{
\item \strong{freq}: Numeric vector of estimated paddle wheel frequencies (Hz),
interpolated to the full length of \code{mz}. \code{NA} values will be present where
a frequency could not be reliably estimated.
\item \strong{speed}: Numeric vector of estimated animal swimming speeds (m/s),
derived from \code{freq} using \code{calibration.slope}.
\item \strong{peak.prominence}: Numeric vector representing the quality of each
frequency estimate (ratio of peak power to maximum power in the valid
frequency range). Only included if \code{quality.check} is TRUE. \code{NA} values
will be present where a quality could not be reliably estimated.
}
}
\description{
Efficient paddle wheel frequency estimation using optimized FFT processing with
improved spectral analysis. The function processes the magnetometer's z-axis
data in overlapping windows, applies Fast Fourier Transform (FFT) to identify
dominant frequencies within a specified range, and converts these frequencies
to animal swimming speeds using a provided calibration slope (assuming a zero y-intercept).
}
