% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculateTailBeats.R
\name{.runCWT}
\alias{.runCWT}
\title{Internal wavelet function}
\usage{
.runCWT(
  dt,
  animal_id,
  id.col,
  datetime.col,
  motion.col,
  min.freq.Hz,
  max.freq.Hz,
  max.rows.per.batch,
  ridge.only,
  power.ratio.threshold,
  smooth.window,
  max.interp.gap,
  plot,
  output.dir,
  png.width,
  png.height,
  png.res,
  n.cores = 1
)
}
\arguments{
\item{dt}{Input data.table for one individual}

\item{animal_id}{ID of current individual}

\item{id.col}{Character. The name of the column identifying individuals (default: "ID").}

\item{datetime.col}{Character. The name of the column containing datetime information (default: "datetime").}

\item{motion.col}{Character. The name of the column containing motion data (e.g., "sway") to analyze.}

\item{min.freq.Hz}{Numeric. The lowest frequency of interest (in Hz). Default is 0.05 Hz.}

\item{max.freq.Hz}{Numeric. The highest frequency of interest (in Hz). Default is 3 Hz.}

\item{max.rows.per.batch}{Numeric. Maximum number of rows to process in each batch when handling large datasets.
The function automatically determines optimal batch sizes based on frequency resolution requirements,
but this parameter sets an upper limit to prevent memory issues. Default is 200,000 rows.
Lower values reduce memory usage but may increase processing time for very large datasets.}

\item{ridge.only}{Logical. If TRUE, only returns frequencies identified as ridges (connected local maxima)
in the wavelet power spectrum. If FALSE (default), uses all local maxima in the power spectrum.}

\item{power.ratio.threshold}{Numeric or NULL. Minimum ratio between peak power and average power
for a frequency to be considered valid. NULL disables this filter. Default is NULL.}

\item{smooth.window}{Numeric. Window size (in seconds) for moving average smoothing of frequency estimates.
Set to 0 to disable smoothing. Default is 10 seconds.}

\item{max.interp.gap}{Numeric. Maximum gap (in seconds) for linear interpolation of missing frequency values.
Set to NULL to disable interpolation. Default is 10 seconds.}

\item{plot}{Logical. Whether to generate plots. Default is TRUE.}

\item{output.dir}{Character. If provided, all plots will be saved as PNG files in this directory instead of being displayed interactively.
Default is NULL (plots shown in R graphics device).}

\item{png.width}{Numeric. Width of PNG output in inches (default = 10).}

\item{png.height}{Numeric. Height of PNG output in inches (default = 7).}

\item{png.res}{Numeric. Resolution of PNG output in ppi (default = 300).}

\item{n.cores}{Number of CPU cores for parallel processing (default = 1)}
}
\value{
data.table with dead-reckoned positions and VPC corrections
}
\description{
Internal wavelet function
}
\note{
This function is intended for internal use within the \code{nautilus} package.
}
\keyword{internal}
