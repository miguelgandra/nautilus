% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/checkVerticalSpeed.R
\name{checkVerticalSpeed}
\alias{checkVerticalSpeed}
\title{Identify and Handle Vertical Displacement Speed Outliers in Time Series Data}
\usage{
checkVerticalSpeed(
  data,
  id.col = "ID",
  depth.col = "depth",
  vertical.speed.threshold,
  sampling.rate,
  depth.sensor.resolution = 0.5,
  depth.sensor.accuracy = 1,
  early.threshold = 0.2,
  late.threshold = 0.8,
  verbose = TRUE
)
}
\arguments{
\item{data}{A data frame or data table containing depth data (from a single animal).}

\item{id.col}{A string representing the column name for the ID field (default is "ID").}

\item{depth.col}{A character string specifying the name of the column containing the depth values. Default is \code{"depth"}.}

\item{vertical.speed.threshold}{A numeric value specifying the threshold for vertical speed outliers (in m/s).}

\item{sampling.rate}{The sampling rate for the data (in Hz), used to adjust the vertical speed calculation. Default is \code{1}.}

\item{depth.sensor.resolution}{Numeric. The fixed uncertainty in the depth reading due to the sensor's resolution (e.g., ±0.5 meters).}

\item{depth.sensor.accuracy}{Numeric. The variable uncertainty in the depth reading, expressed as a percentage of the measured depth (e.g., ±1\% of the depth reading).}

\item{early.threshold}{A numeric value between 0 and 1 that defines the portion of the dataset considered as the early / pre-deployment phase.
Rows falling within the first early.threshold * 100\% of the dataset are classified as part of this phase.
Anomalies detected in this range will result in the removal of all earlier rows. The default value is 0.2 (20\%).}

\item{late.threshold}{A numeric value between 0 and 1 that defines the portion of the dataset considered as the late / post-deployment phase.
Rows falling within the last (1 - late.threshold) * 100\% of the dataset are classified as part of this phase.
Anomalies detected in this range will result in the removal of all subsequent rows. The default value is 0.8 (80\%).}

\item{verbose}{Logical. If TRUE, the function will print detailed processing information. Defaults to TRUE.}
}
\value{
A data frame (\code{data}) with rows containing vertical speed outliers removed.
}
\description{
This function checks for vertical displacement speed outliers in the data, where vertical speed
is calculated as the absolute difference in depth between consecutive measurements, adjusted for
the sampling rate. Spurious data points with vertical speeds exceeding a user-specified threshold
are flagged. Rows corresponding to these anomalies are removed based on their position relative to
two customizable thresholds:
\itemize{
\item \strong{Early data period:} If anomalies occur within the first early.threshold\% of the dataset,
all rows before the last anomaly in this range are discarded.
\item \strong{Late data period:} If anomalies occur within the last late.threshold\% of the dataset,
all rows after the first anomaly in this range are discarded.
}
}
\details{
Anomalies detected within the central portion of the dataset, outside these thresholds, will not result in
any rows being removed. Instead, a warning is issued to alert the user to potential data irregularities
requiring manual inspection.
}
